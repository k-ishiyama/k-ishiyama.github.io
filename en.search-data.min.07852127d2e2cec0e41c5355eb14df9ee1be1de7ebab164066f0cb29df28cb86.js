'use strict';(function(){const indexCfg={cache:true};indexCfg.doc={id:'id',field:['title','content'],store:['title','href','section'],};const index=FlexSearch.create('balance',indexCfg);window.bookSearchIndex=index;index.add({'id':0,'href':'/docs/physics/','title':"Physics",'section':"Docs",'content':"物理に関する話題をまとめる.\n"});index.add({'id':1,'href':'/docs/radiative_transfer/','title':"Radiative Transfer",'section':"Docs",'content':"Boltzmann 方程式を元に, 光の輸送計算を行う分野を Radiative Transfer としてまとめる.\n"});index.add({'id':2,'href':'/docs/physics/analytical_mechanics/','title':"Analytical Mechanics",'section':"Physics",'content':"Analytical Mechanics #  Hamilton\u0026rsquo;s Principle #  \\(N\\)次元ユークリッド空間を考えて, 時間を \\(t\\), 座標を \\(\\bm{q}(t)=\\begin{pmatrix}q_1(t) \\\\ q_2(t) \\\\ \\vdots \\\\ q_N(t)\\end{pmatrix}\\) と書く.\nそして, 時間による微分を\t\\(\\dot{\\bm{q}}:=\\frac{d\\bm{q}}{dt}\\) と略記する.\n空間中にラグランジアン \\(L(\\bm{q},\\dot{\\bm{q}},t)\\) なる量を考え, 曲線 \\(\\bm{q}(t)\\) に沿った線積分   \\[\tS[\\bm{q}] = \\int^b_aL(\\bm{q},\\dot{\\bm{q}},t)dt \\tag{hp.1}\\]  を作用と呼ぶ.\n作用は \\(\\bm{q}(t)\\) を引数とする汎関数になっている. 作用が停留点をとる経路上では, その変分 \\(\\delta S\\) が 0 になる  \\[\t\\delta S[\\bm{q}] = 0. \\tag{hp.2}\\]  この式 (hp.2) を Hamilton の原理と呼ぶ.\nこのような経路は, 力学では質点の運動の軌跡, 幾何光学では光線の軌跡, 幾何音響学では音響エネルギーの軌跡に対応する. この原理の元に構築される解析力学の手法は, 各分野に共通して用いることができる.\nEuler-Lagrange Equation #  作用 \\(S\\) について, 始点 \\(\\bm{q}(a)\\) と終点 \\(\\bm{q}(b)\\) を固定し, \\(S\\) が停留値をとる \\(\\bm{q}(t)\\) を求めるとする. そのような \\(\\bm{q}\\) に対する条件は, Euler-Lagrange 方程式  \\[\t\\frac{\\partial L}{\\partial\\bm{q}} - \\frac{d}{dt}\\left(\\frac{\\partial L}{\\partial\\dot{\\bm{q}}}\\right) = 0 \\tag{el.1}\\]  で与えられる.\nHamilton\u0026rsquo;s Equations #  運動量を  \\[\t\\bm{p} := \\frac{\\partial L}{\\partial\\dot{\\bm{q}}} \\tag{he.1}\\]  と定義し, Legendre 変換  \\[\tH(\\bm{q},\\bm{p},t) := \\bm{p}\\cdot\\dot{\\bm{q}} - L(\\bm{q},\\dot{\\bm{q}},t) \\tag{he.2}\\]  によって, 変数 \\(\\dot{\\bm{q}}\\) を \\(\\bm{p}\\) へ変換する. ここで導入した \\(H(\\bm{q},\\bm{p},t)\\) を Hamiltonian という.\nこれにより, 作用が停留値をとる条件は  \\[\t\\dot{\\bm{q}} = \\frac{\\partial H}{\\partial\\bm{p}},\\quad \\dot{\\bm{p}} = -\\frac{\\partial H}{\\partial\\bm{q}} \\tag{he.3}\\]  となる. これを Hamilton の運動方程式という.\n質点の座標 \\(\\bm{q}\\) を持つ空間を配位空間, 座標と運動量 \\((\\bm{q},\\bm{p})\\) を持つ空間を相空間と呼ぶ.\nHamilton\u0026ndash;­Jacobi Equation #  作用 \\(S\\) について, 始点 \\(\\bm{q}(a)\\) を固定し, 終点 \\(\\bm{q}(t)\\) を自由に動かすとする. このとき, 停留値を取る \\(\\bm{q}(t)\\) を与える \\(S(\\bm{q},t)\\) について, Hamilton-Jacobi 方程式  \\[\t-\\frac{\\partial S}{\\partial t} = H\\left(\\bm{q},\\frac{\\partial S}{\\partial q},t\\right)\\]  が成り立つ.\nCanonical Transformation #  変数変換 \\( (\\bm{q},\\bm{p})\\rightarrow(\\bm{Q},\\bm{P}) \\) を考える.  \\[\t\\bm{q}\\rightarrow \\bm{Q}(\\bm{q},\\bm{p},t),\\quad \\bm{p}\\rightarrow \\bm{P}(\\bm{q},\\bm{p},t) \\tag{ct.1}\\]  この変換に伴って変化した Hamiltonian を \\(K(\\bm{Q},\\bm{P},t)\\) と書き, 新しい変数 \\((\\bm{Q},\\bm{P})\\) についても Hamilton の運動方程式 (he.3)  \\[\t\\dot{\\bm{Q}} = \\frac{\\partial K}{\\partial\\bm{P}},\\quad \\dot{\\bm{P}} = -\\frac{\\partial K}{\\partial\\bm{Q}} \\tag{ct.2}\\]  が成り立つとき, 変数変換 \\((\\bm{q},\\bm{p})\\rightarrow(\\bm{Q},\\bm{P})\\) を正準変換と呼ぶ.\n正準変換は, Hamilton の原理 (hp.2) から導かれるから,  \\[\t\\int^b_a\\left(\\bm{p}\\cdot\\dot{\\bm{q}}-H(\\bm{p},\\bm{q})\\right)dt = \\int^b_a\\left(\\bm{P}\\cdot\\dot{\\bm{Q}} - K(\\bm{Q},\\bm{P}) \u0026#43; \\frac{dG(\\bm{q},\\bm{p},\\bm{Q},\\bm{P},t)}{dt}\\right)dt \\tag{ct.3}\\]  より  \\[\t\\bm{p}\\cdot\\dot{\\bm{q}}-H(\\bm{p},\\bm{q}) = \\bm{P}\\cdot\\dot{\\bm{Q}} - K(\\bm{Q},\\bm{P}) \u0026#43; \\frac{dG(\\bm{q},\\bm{p},\\bm{Q},\\bm{P},t)}{dt} \\tag{ct.4}\\]  が成り立つ必要がある. ここで, \\(\\bm{p}\\cdot\\dot{\\bm{q}}\\) が \\(\\bm{P}\\cdot\\dot{\\bm{Q}}\\) に変化したぶんの補正で, ハミルトニアンの変化のほかに任意関数 \\(G(\\bm{q},\\bm{p},\\bm{Q},\\bm{P},t)\\) で表されるとした.\nGenerating Function #  式(ct.3)で導入した任意関数 \\( G \\) の \\(4N\\) 個の引数 \\( \\bm{q},\\bm{p},\\bm{Q},\\bm{P} \\) のうち, 独立な変数は \\( 2N \\) 個となっている. 従って, その独立変数の選び方には \\( (\\bm{q},\\bm{Q}),(\\bm{q},\\bm{P}),(\\bm{p},\\bm{Q}),(\\bm{p},\\bm{P}) \\) の4通りがある.\nはじめに \\( (\\bm{q},\\bm{Q}) \\) を考える. この場合の \\(G\\) を \\(G=G_1(\\bm{q},\\bm{Q},t)\\) と書く. \\(G_1\\)の全微分を取ると,  \\[\t\\frac{dG_1(\\bm{q},\\bm{Q},t)}{dt} = \\frac{\\partial G_1}{\\partial\\bm{q}}\\cdot\\dot\\bm{q} \u0026#43; \\frac{\\partial G_1}{\\partial\\bm{Q}}\\cdot\\dot\\bm{Q} \u0026#43; \\frac{\\partial G_1}{\\partial t}\\]  となる. これを式 (ct.4) へ代入すると,  \\[\t\\bm{p}\\cdot\\dot{\\bm{q}} - \\bm{P}\\cdot\\dot{\\bm{Q}} \u0026#43; (K - H) = \\frac{\\partial G_1}{\\partial\\bm{q}}\\cdot\\dot\\bm{q} \u0026#43; \\frac{\\partial G_1}{\\partial\\bm{Q}}\\cdot\\dot\\bm{Q} \u0026#43; \\frac{\\partial G_1}{\\partial t}\\]  となる. 両辺の各項を比較すれば,  \\[\t\\bm{p} = \\frac{\\partial G_1(\\bm{q},\\bm{Q},t)}{\\partial\\bm{q}},\\quad \\bm{P} = -\\frac{\\partial G_1(\\bm{q},\\bm{Q},t)}{\\partial\\bm{Q}},\\quad K = H \u0026#43; \\frac{\\partial G_1(\\bm{q},\\bm{Q},t)}{\\partial t}\\]  が得られる. 任意関数 \\(G_1\\) は, \\(\\bm{q},\\bm{Q}\\) を引数として \\(\\bm{p},\\bm{P}\\) を生成することから, 生成母関数とよぶ.\nそのほか, \\((\\bm{q},\\bm{P}),(\\bm{p},\\bm{Q}),(\\bm{p},\\bm{P})\\) についても, Legendre 変換によって変数変換を繰り返すことで, 同様の関係を得ることができる. これをまとめると, 下記の表となる.\n   Generating function Dependent variables New Hamiltonian     \\(G = G_1(\\bm{q},\\bm{Q},t)\\) \\(\\bm{p}=\\frac{\\partial G_1}{\\partial\\bm{q}},\\; \\bm{P} = -\\frac{\\partial G_1}{\\partial\\bm{Q}}\\) \\(K = H + \\frac{\\partial G_1}{\\partial t}\\)   \\(G = -\\bm{P}\\cdot\\bm{Q}+G_2(\\bm{q},\\bm{P},t)\\) \\(\\bm{p}=\\frac{\\partial G_2}{\\partial\\bm{q}},\\; \\bm{Q} = -\\frac{\\partial G_2}{\\partial\\bm{P}}\\) \\(K = H + \\frac{\\partial G_2}{\\partial t}\\)   \\(G = \\bm{p}\\cdot\\bm{q}+G_3(\\bm{q},\\bm{P},t)\\) \\(\\bm{q}=-\\frac{\\partial G_3}{\\partial\\bm{p}},\\; \\bm{P} = -\\frac{\\partial G_3}{\\partial\\bm{Q}}\\) \\(K = H + \\frac{\\partial G_3}{\\partial t}\\)   \\(G = \\bm{p}\\cdot\\bm{q}-\\bm{P}\\cdot\\bm{Q}+G_4(\\bm{q},\\bm{P},t)\\) \\(\\bm{q}=-\\frac{\\partial G_4}{\\partial\\bm{p}},\\; \\bm{Q} = \\frac{\\partial G_4}{\\partial\\bm{P}}\\) \\(K = H + \\frac{\\partial G_4}{\\partial t}\\)    Symplectic Approach #  \\(2N\\) ベクトル \\(\\bm{\\eta}:=\\begin{pmatrix}\\bm{q} \\\\ \\bm{p}\\end{pmatrix}\\) と, \\(2N\\times 2N\\) 行列 \\(\\Omega\\),  \\[\t\\Omega:= \\begin{pmatrix} 0\t\u0026amp; \\bm{1} \\\\ -\\bm{1} \u0026amp; 0 \\end{pmatrix}\\]  を使って, Hamilton の運動方程式 (he.3) を  \\[\t\\dot{\\bm{\\eta}} = \\Omega\\frac{\\partial H}{\\partial\\bm{\\eta}}\\]  と書く. また, 正準変換 (ct.1) も \\(\\bm{\\xi}(\\bm{\\eta}):=\\begin{pmatrix}\\bm{Q} \\\\ \\bm{P}\\end{pmatrix}\\) とまとめて書くと, その時間微分は\n \\[\t\\dot{\\bm{\\xi}} = M\\dot{\\bm{\\eta}},\\quad M := \\frac{\\partial\\bm{\\xi}}{\\partial\\bm{\\eta}}\\]  と表される. ただし \\(M\\) は変数変換のヤコビアン.\n \\[\t\\dot{\\bm{\\xi}} = M\\Omega\\frac{\\partial H}{\\partial\\bm{\\eta}} = M\\Omega\\frac{\\partial H}{\\partial\\bm{\\xi}}\\frac{\\partial\\bm{\\xi}}{\\partial\\bm{\\eta}} = M\\Omega M^T\\frac{\\partial H}{\\partial\\bm{\\xi}}\\]  従って  \\[\tM\\Omega M^T = \\Omega\\]  が正準変換の条件になる. この条件を Symplectic 関係式, \\(M\\)を Symplectic 行列と呼ぶ.\nIdentical Transformation #  生成母関数を \\(G_2(\\bm{q},\\bm{P},t)=\\bm{q}\\cdot\\bm{P}\\) ととると,  \\[\t\\bm{p}=\\frac{\\partial G_2}{\\partial\\bm{q}}=\\bm{P},\\quad \\bm{Q} = -\\frac{\\partial G_2}{\\partial\\bm{P}}=\\bm{q},\\quad K = H \\tag{it.1}\\]  となる. これは正準変換で何も変わらない. これを恒等変換という.\nInfinitesimal Canonical Transformation #  無限小の量を \\(\\epsilon\\) と書き, 恒等変換から \\(\\epsilon G(\\bm{q},\\bm{P})\\) だけずれた変換を考える.  \\[\tG_2(\\bm{q},\\bm{P},t)=\\bm{q}\\cdot\\bm{P}\u0026#43;\\epsilon G(\\bm{q},\\bm{P})\\]  (it.1)式より  \\[\\begin{aligned} \\bm{Q} \u0026amp;= \\bm{q} \u0026#43; \\epsilon\\frac{\\partial G(\\bm{q},\\bm{P})}{\\partial\\bm{P}}\\\\ \\bm{P} \u0026amp;= \\bm{p} - \\epsilon\\frac{\\partial G(\\bm{q},\\bm{P})}{\\partial\\bm{q}} \\end{aligned} \\tag{ic.1}\\]  これが正準変換になっているかどうかを確かめる. 上式をまとめて書くと  \\[\t\\bm{\\xi} = \\bm{\\eta} \u0026#43; \\epsilon \\Omega\\frac{\\partial G}{\\partial\\bm{\\eta}}\\]  これが Symplectic 関係式を満たすかどうかを調べる. Symplectic行列 \\(M\\) は  \\[\\begin{aligned} M \u0026amp;= \\frac{\\partial\\bm{\\xi}}{\\partial\\bm{\\eta}} = \\bm{1} \u0026#43; \\epsilon\\Omega\\frac{\\partial^2G}{\\partial\\bm{\\eta}\\partial\\bm{\\eta}}\\\\ M^T \u0026amp;= \\bm{1} - \\epsilon\\frac{\\partial^2G}{\\partial\\bm{\\eta}\\partial\\bm{\\eta}}\\Omega \\end{aligned}\\]  となる. これにより, Symplectic 関係式は  \\[\\begin{aligned} M\\Omega M^T \u0026amp;= \\left(\\bm{1} \u0026#43; \\epsilon\\Omega\\frac{\\partial^2G}{\\partial\\bm{\\eta}\\partial\\bm{\\eta}}\\right) \\Omega \\left(\\bm{1} - \\epsilon\\frac{\\partial^2G}{\\partial\\bm{\\eta}\\partial\\bm{\\eta}}\\Omega\\right)\\\\ \u0026amp;= \\Omega \u0026#43; \\epsilon\\Omega\\frac{\\partial^2G}{\\partial\\bm{\\eta}\\partial\\bm{\\eta}}\\Omega - \\epsilon\\Omega\\frac{\\partial^2G}{\\partial\\bm{\\eta}\\partial\\bm{\\eta}}\\Omega\\\\ \u0026amp;= \\Omega \\end{aligned}\\]  となる. 従って, 無限小変換 (ic.1) は正準変換であることがわかる.\nTime Evolution #  時間 \\(t\\) に \\((\\bm{q}(t), \\bm{p}(t))\\) であった状態が, \\(dt\\) だけ経過したのち \\((\\bm{q}(t+dt), \\bm{p}(t+dt))\\) になったとする.  \\[\\begin{aligned} \\bm{Q}(t) \u0026amp;:= \\bm{q}(t\u0026#43;dt) = \\bm{q}(t) \u0026#43; \\dot{\\bm{q}}(t)dt\\\\ \\bm{P}(t) \u0026amp;:= \\bm{p}(t\u0026#43;dt) = \\bm{p}(t) \u0026#43; \\dot{\\bm{p}}(t)dt \\end{aligned}\\]  \\(\\dot{\\bm{q}}, \\dot{\\bm{p}}\\) にHamilton の運動方程式を適用すると  \\[\\begin{aligned} \\bm{Q}(t) \u0026amp;= \\bm{q}(t) \u0026#43; \\frac{\\partial H}{\\partial\\bm{p}}dt\\\\ \\bm{P}(t) \u0026amp;= \\bm{p}(t) - \\frac{\\partial H}{\\partial\\bm{q}}dt \\end{aligned}\\]   無限小正準変換 で考察した内容から, 時間発展は正準変換であり, その生成子は Hamiltonian であることがわかる.\nLiouville Theorem #  正準変換 \\((\\bm{q},\\bm{p})\\rightarrow(\\bm{Q},\\bm{P})\\) による変数変換は  \\[\t\\int d\\bm{Q}d\\bm{P} = \\int|\\det M|d\\bm{q}d\\bm{p}\\]  と書ける.\nSymplectic関係式の行列式をとると  \\[\t(\\det M)^2\\det\\Omega = \\det\\Omega\\]  だから, \\(|M|=\\pm 1\\) となる.\n従って, 正準変換で相空間の体積要素 \\(d\\bm{q}d\\bm{p}\\) は変化しない. これを Liouville の定理という.\n"});index.add({'id':3,'href':'/docs/radiative_transfer/radiative_transfer_equation/','title':"Radiative Transfer Equation",'section':"Radiative Transfer",'content':"Linear Boltzmann Equation for Photons #  平衡状態にある散乱媒質と, 光子に関する Linear Boltzmann 方程式 を考える. 全ての光子は速度 \\(c\\) で運動するとし, 散乱媒質はその速度に比べて十分遅いとする. また, 光子の密度関数を 分光放射輝度 として \\(L(\\bm{\\omega})=L(\\bm{x},\\bm{\\omega},\\nu,t)\\) と書き, 散乱媒質に対する光の入射方向を \\(\\bm{\\omega}_i\\), 出射方向を \\(\\bm{\\omega}_o\\) と書く.\nこのとき, Linear Boltzmann 方程式は   \\[\t\\frac{1}{c}\\frac{\\partial L(\\bm{\\omega}_o)}{\\partial t} \u0026#43; \\bm{\\omega}_o\\cdot\\frac{\\partial L(\\bm{\\omega}_o)}{\\partial\\bm{x}} = \\mu_s\\int_{S^2}p(\\bm{\\omega}_i, \\bm{\\omega}_o)L(\\bm{\\omega}_i)d\\bm{\\omega}_i - \\mu_s L(\\bm{\\omega}_o)\\]  となる [ Cercignani, 1988].\nScattering Coefficient #  \\(\\mu_s\\)は散乱係数と呼ばれる量で, 単位長さあたりに存在する媒質粒子数を表す.\n散乱媒質の 密度関数 を \\(F(\\bm{x},\\bm{p},t)\\) とかけば, その個数密度は \\(n(\\bm{x},t)=\\int F(\\bm{x},\\bm{p},t)d\\bm{p}\\) と得られる. これと 散乱断面積 \\(\\sigma_s\\) から, 散乱係数は  \\[\t\\mu_s(\\bm{x},t) := n(\\bm{x},t)\\,\\sigma_s\\qquad[\\text{m}^{-1}]\\]  と与えられる.\nPhase Function #   微分散乱断面積 \\(g(\\bm{\\omega}_i,\\bm{\\omega}_o)\\) を 散乱断面積 \\(\\sigma_s\\) で規格化した量,  \\[\tp(\\bm{\\omega}_i,\\bm{\\omega}_o) = \\frac{1}{\\sigma_s}\\,g(\\bm{\\omega}_i,\\bm{\\omega}_o) \\qquad [\\text{sr}^{-1}]\\]  を散乱の位相関数と呼ぶ.\nLocal Thermodynamic Equilibrium #   光子に対する Linear Boltzmann 方程式 の右辺は, 散乱媒質に衝突した光子の獲得と消失を表現している. これに, 媒質による光子の吸収と放出を加えたい.\nこの際, 吸収と放出は少なくとも局所的に平衡状態にあるとして, 放出は熱放射で起こると仮定する[ Chandrasekhar, 1960].\n光子の吸収は, 吸収係数 \\(\\mu_a\\) を導入して, \\(\\mu_a L\\) と表現する.\nキルヒホッフの法則より, 吸収した光子が媒質粒子内部で熱となる割合は吸収係数に等しいから, 放出は黒体輻射の輝度 \\(B(\\nu,T)\\) を使って \\(\\mu_a B\\) と表現する. また, 熱放射は等方的とする.\nRadiative Transfer Equation #   光子に対する Linear Boltzmann 方程式 へ, 局所熱平衡 による光子の吸収と放出を加えた式  \\[\t\\left(\\frac{1}{c}\\frac{\\partial}{\\partial t} \u0026#43; \\bm{\\omega}_o\\cdot\\nabla \u0026#43; \\mu_t\\right)L(\\bm{x},\\bm{\\omega}_o,\\nu,t) = \\mu_a B(\\nu,T) \u0026#43; \\mu_s\\int_{S^2}p(\\bm{\\omega}_i, \\bm{\\omega}_o)L(\\bm{x},\\bm{\\omega}_i,\\nu,t)d\\bm{\\omega}_i\\]  を, Radiative Transfer 方程式と呼ぶ. ここで \\(\\mu_t=\\mu_s+\\mu_a\\) と書いた.\n"});index.add({'id':4,'href':'/docs/physics/geometrical_optics/','title':"Geometrical Optics",'section':"Physics",'content':"Geometrical Optics #  Ray of Light #  細く絞った光のビームを考え, その光が通った経路を光線と呼ぶ.\nここで考えた光線は, のちに同じ波面を共有する光子の集団として正当化する(ToDo).\nIndex of Refraction #  光は, 真空中では速さ \\(c\\;[\\text{m}/\\text{s}]\\) で空間を伝搬する. そして, 物質中を伝わる光の速さ \\(v\\;[\\text{m}/\\text{s}]\\) は真空中よりも遅くなる. この速度の比   \\[\tn = \\frac{c}{v}\\quad\\;[-]\\]  を屈折率と呼ぶ.\n物質中で光が遅くなる理由は, のちに誘電体の分極から説明する( Born and Wolf, 1999, Sec. 2.2)(ToDo).\nOptical Path Length #  時間 \\(t\\;[\\text{s}]\\) のあいだに光が真空中を進む距離は \\(ct\\;[\\text{m}]\\), 屈折率 \\(n\\) の媒質中を進む距離は \\(vt\\;[\\text{m}]\\) となる. このとき, 媒質中を進む距離に屈折率を掛け, 真空中を進む距離に換算した量 \\(nvt\\;[\\text{m}]\\) を光路長と呼ぶ.\nFermat\u0026rsquo;s Principle #  光線は屈折率の変動に応じて曲がる. その経路は, フェルマーの原理「光線は光路長が停留値となる経路をとる」によって決まる ( Born and Wolf, 1999, 山本, 2014).\n光線の経路を3次元空間中の空間曲線として \\(\\bm{r}(t)=\\begin{pmatrix}x(t)\\\\y(t)\\\\z(t)\\end{pmatrix},\\;(a\\leq t\\leq b)\\), その位置に応じて変わる屈折率を \\(n(\\bm{r})\\) と書く. このとき, 光路長 \\(S\\) は曲線 \\(\\bm{r}\\) を引数とする汎関数として  \\[\tS(\\bm{r}) = \\int^b_a n(\\bm{r})\\left|\\frac{d\\bm{r}}{dt}\\right|dt\\]  となる. 従ってフェルマーの原理は, 汎関数 \\(S\\) の変分 \\(\\delta S\\) を 0 にする経路 \\(\\bm{r}\\) を求める問題として,  \\[\t\\delta S(\\bm{r}) = 0\\]  と表される.\nここで, パラメータ \\(t\\) を \\(z\\)軸にとり, 光線の経路 \\(\\bm{r}\\) を  \\[\t\\bm{r}(t)=\\begin{pmatrix}\\bm{q}(t) \\\\ t\\end{pmatrix},\\quad \\bm{q}(t)=\\begin{pmatrix}x(t) \\\\ y(t)\\end{pmatrix}\\]  と表す. また, \\(t\\) による微分を \\(\\dot{\\bm{q}} = \\frac{d\\bm{q}}{dt}\\) と略記する. するとフェルマーの原理は,  \\[\tS[\\bm{q},t] = \\int^b_aL(\\bm{q},\\dot{\\bm{q}},t)dt,\\quad L(\\bm{q},\\dot{\\bm{q}},t) = n(\\bm{q},t)|\\dot{\\bm{r}}|\\]  と表せる. これは, 配位空間を2次元とする Hamiltonの原理に等しい.\n"});index.add({'id':5,'href':'/docs/radiative_transfer/rendering_equation/','title':"Rendering Equation",'section':"Radiative Transfer",'content':"Volume Rendering Equation #  時間に依存しない Radiative Transfer 方程式 を考える.   \\[\t\\left(\\bm{\\omega}_o\\cdot\\nabla \u0026#43; \\mu_t\\right)L(\\bm{x},\\bm{\\omega}_o,\\nu) = s(\\bm{x},\\bm{\\omega}_o) \u0026#43; \\mu_s\\int_{S^2}p(\\bm{\\omega}_i, \\bm{\\omega}_o)L(\\bm{x},\\bm{\\omega}_i,\\nu)d\\bm{\\omega}_i\\]  これを, Volume Rendering 方程式 [ Jensen et al., 2001] と呼ぶことにする.\nただし, 光の放出は熱放射に限らないとして, 黒体輻射の輝度 \\(B\\) を source 項  \\[\ts(\\bm{x},\\bm{\\omega}_o) = \\mu_t L_\\epsilon(\\bm{x}) \u0026#43; \\mu_a L_\\text{re}(\\bm{x},\\bm{\\omega}_o)\\]  で置き換えた. \\(L_\\epsilon\\) は媒質の自己放射で, \\(L_\\text{re}\\) は媒質が吸収した光の再放出とする.\nRendering Equation #  物体の表面として, 衝突率が 100% の媒質を考える. この場合, 光が媒質を通り抜けることはないから, \\(\\bm{\\omega}_o\\cdot\\nabla L(\\bm{x},\\bm{\\omega}_o,\\nu) = 0\\) となる. 従って Volume Rendering 方程式 は,  \\[\t\\mu_tL(\\bm{x},\\bm{\\omega}_o,\\nu) = \\mu_t L_\\epsilon(\\bm{x}) \u0026#43; \\mu_a L_\\text{re}(\\bm{x},\\bm{\\omega}_o) \u0026#43; \\mu_s\\int_{S^2}p(\\bm{\\omega}_i, \\bm{\\omega}_o)L(\\bm{x},\\bm{\\omega}_i,\\nu)d\\bm{\\omega}_i\\]  となる. ここで反射率 \\(k_s:=\\frac{\\mu_s}{\\mu_t}\\), 吸収率 \\(k_a:=\\frac{\\mu_s}{\\mu_t}\\) という量を定義し, 表面の法線を \\(\\bm{\\omega}_n\\) として \\(p(\\bm{\\omega}_i,\\bm{\\omega}_o) \\rightarrow f_r(\\bm{\\omega}_i,\\bm{\\omega}_o)(\\bm{\\omega}_i\\cdot\\bm{\\omega}_n)\\) と書き換えれば,  \\[\tL(\\bm{x},\\bm{\\omega}_o,\\nu) = L_\\epsilon(\\bm{x}) \u0026#43; k_a L_\\text{re}(\\bm{x},\\bm{\\omega}_o) \u0026#43; k_s\\int_{H^\u0026#43;}f(\\bm{\\omega}_i, \\bm{\\omega}_o)(\\bm{\\omega}_i\\cdot\\bm{\\omega}_n)L(\\bm{x},\\bm{\\omega}_i,\\nu)d\\bm{\\omega}_i\\]  が得られる. この文書では, これを Rendering 方程式とよぶ. なお, 位置 \\(\\bm{x}\\) で \\(\\bm{\\omega}_n\\) を法線とする半球面を \\(H^+:=\\{\\bm{\\omega}\\in S^2 : \\bm{\\omega}\\cdot\\bm{\\omega}_n(\\bm{x})\\ge0\\}\\) と書いた.\nBidirectional Reflectance Distribution Function #  上記の Rendering 方程式 では, 散乱の位相関数 \\(p(\\bm{\\omega}_i,\\bm{\\omega}_o)\\) を \\(f_r(\\bm{\\omega}_i,\\bm{\\omega}_o)(\\bm{\\omega}_i\\cdot\\bm{\\omega}_n)\\) と置き換えた. この \\(f_r(\\bm{\\omega}_i,\\bm{\\omega}_o)\\) を Bidirectional Reflectance Distribution Function (BRDF) と呼ぶ.\nBRDF はもともと, 光の入射照度と反射輝度の比として定義されている[ Nicodemus, 1965]. しかし, この文書では, 法線 \\(\\bm{\\omega}_n\\) を持つ表面の散乱断面積から, BRDF の定義を与えることを考える.\n法線 \\(\\bm{\\omega}_n\\) を持つ微小面を \\(d\\sigma_n\\), その面を \\(\\bm{\\omega}_i\\) 方向へ射影した面を \\(d\\sigma=(\\bm{\\omega}_i\\cdot\\bm{\\omega}_n)d\\sigma_n\\) と書く.\n  Fig. \\(d\\sigma=(\\bm{\\omega}_i\\cdot\\bm{\\omega}_n)d\\sigma_n\\)\n   このとき, 散乱断面積は  \\[\t\\sigma_s = \\int_{H^\u0026#43;}\\left|\\frac{d\\bm{\\sigma}}{d\\bm{\\omega}_i}\\right|d\\bm{\\omega}_i = \\int_{H^\u0026#43;}\\left|\\frac{d\\bm{\\sigma}_n}{d\\bm{\\omega}_i}\\right|(\\bm{\\omega}_i\\cdot\\bm{\\omega}_n)d\\bm{\\omega}_i\\]  となる. この 微分散乱断面積 \\(\\left|\\frac{d\\bm{\\sigma}_n}{d\\bm{\\omega}_i}\\right|\\) を散乱断面積 \\(\\sigma_s\\) で規格化した量を, BRDFと呼ぶ  \\[\tf(\\bm{\\omega}_i,\\bm{\\omega}_o) = \\frac{1}{\\sigma_s} \\left|\\frac{d\\bm{\\sigma}_n}{d\\bm{\\omega}_i}\\right| \\qquad[\\text{sr}^{-1}]\\]  BRDF は次の規格化条件を満たす.  \\[\t\\int_{H^\u0026#43;}f(\\bm{\\omega}_i,\\bm{\\omega}_o)(\\bm{\\omega}_i\\cdot\\bm{\\omega}_n)d\\bm{\\omega}_i = 1\\]  "});index.add({'id':6,'href':'/docs/radiative_transfer/microfacet_model/','title':"Microfacet Model",'section':"Radiative Transfer",'content':"Microfacet Model #   Rendering 方程式 では, 物体表面上の光反射は   \\[\tL(\\bm{x},\\bm{\\omega}_o,\\nu) = \\int_{H^\u0026#43;}f(\\bm{\\omega}_i, \\bm{\\omega}_o)L(\\bm{x},\\bm{\\omega}_i,\\nu)(\\bm{\\omega}_n\\cdot\\bm{\\omega}_i)d\\bm{\\omega}_i\\]  と表された.\nいま, 粗い面による光反射を表現するために, 表面が微細な凸凹の集まりによってできていると仮定する. そして, 微細な凸凹の情報は, 法線分布関数やマスキング関数といった, 統計的な量に格納されているとする. このようにして粗い面をモデル化したものを, Microfacet モデルと呼ぶ. 以後, 微細な凸凹のひとつひとつを Microsurface、その集まりによってできた面を Macrosurface と呼んで区別する [ Pharr et al., 2018].\nなお, この文書では Microsurface の BRDF を用いて Macrosurface の BRDF を導く流れ [ Walter et al., 2007, Heitz, 2014] と異なり, 微分散乱断面積 から Macrosurface の BRDF を導く.\nHalf Vector #  入射光の方向を \\(\\bm{\\omega}_i\\), 反射光の方向を \\(\\bm{\\omega}_o\\) とし, 次の量  \\[\t\\bm{\\omega}_h := \\frac{\\bm{\\omega}_i \u0026#43; \\bm{\\omega}_o}{|\\bm{\\omega}_i \u0026#43; \\bm{\\omega}_o|}\\]  をハーフベクトルと呼ぶ.\n以後, Microsurface の表面が完全鏡面であると仮定したとき, Microsurface の法線 \\(\\bm{\\omega}_m\\) は ハーフベクトル \\(\\bm{\\omega}_h\\) に等しい.  \\[\t\\bm{\\omega}_m = \\bm{\\omega}_h\\]  Normal Distribution Function #  単位立体角当たりの散乱断面積である 微分散乱断面積 と同様の議論で, 単位立体角当たりの Microsurface 表面積である法線分布関数を導入する.\n\\(\\bm{\\omega}_i\\) から入射した光が, 法線\\(\\bm{\\omega}_m\\) の Microsurface に当たり, \\(\\bm{\\omega}_o\\) へ反射することを考える. また, Microsurface は完全鏡面であると仮定する.\n\\(\\bm{\\omega}_i\\) と \\(\\bm{\\omega}_m\\) のなす角を \\(\\theta_m,\\phi_m\\), 微小立体角を \\(d\\bm{\\omega}_m=\\sin\\theta_m d\\theta_m d\\phi_m\\) と書く. また, 微小散乱断面積 \\(d\\sigma\\) と Microsurface 上の微小面積 \\(d\\sigma_m\\) には, \\(d\\sigma = (\\bm{\\omega}_i\\cdot\\bm{\\omega}_m)d\\sigma_m\\) という関係がある.\n  Fig. \\(d\\sigma=(\\bm{\\omega}_i\\cdot\\bm{\\omega}_m)d\\sigma_m\\)\n   Microsurface 上の半球面 \\(H^+\\) を考えて, 散乱断面積 \\(\\sigma_s\\) を  \\[\t\\sigma_s = \\int_{H^\u0026#43;}d\\bm{\\sigma} = \\int_{H^\u0026#43;}\\left|\\frac{d\\bm{\\sigma}}{d\\bm{\\omega}_m}\\right|d\\bm{\\omega}_m = \\int_{H^\u0026#43;}\\left|\\frac{d\\bm{\\sigma}_m}{d\\bm{\\omega}_m}\\right|(\\bm{\\omega}_i\\cdot\\bm{\\omega}_m)d\\bm{\\omega}_m\\]  と表す.\nそして, 散乱断面積で規格化した, 単位立体角あたりの Microsurface 表面積  \\[\tD(\\bm{\\omega}_m) := \\frac{1}{\\sigma_s}\\left|\\frac{d\\bm{\\sigma}_m}{d\\bm{\\omega}_m}\\right|\\]  を法線分布関数と呼ぶ.\nこの定義から, 法線分布関数は  \\[\t\\int_{H^\u0026#43;}D(\\bm{\\omega}_m)(\\bm{\\omega}_i\\cdot\\bm{\\omega}_m)d\\bm{\\omega}_m = 1\\]  と規格化されている.\nMasking Function #  Microsurface によって作られる粗い面は, 同じ法線分布関数 \\(D(\\bm{\\omega}_m)\\) を持つ限り, 同じ形状が連なっている. この場合, 隣接する Microsurface 同士の遮蔽を考慮する必要がある.\nいま, 法線 \\(\\bm{\\omega}_n\\) を持つ Macrosurface を \\(\\bm{\\omega}_o\\) から眺めたとする. このとき, \\(\\bm{\\omega}_o\\) 方向から眺めた散乱断面積は \\(|\\bm{\\omega}_o\\cdot\\bm{\\omega}_n|\\sigma_s\\) となる. これを考慮して, Microsurface 同士の遮蔽を表す Masking 関数 \\(G_1(\\bm{\\omega}_o,\\bm{\\omega}_m)\\) を次のように導入する  \\[\t|\\bm{\\omega}_o\\cdot\\bm{\\omega}_n|\\sigma_s = \\int_{H^\u0026#43;}G_1(\\bm{\\omega}_o,\\bm{\\omega}_m)\\left|\\frac{d\\bm{\\sigma}}{d\\bm{\\omega}_m}\\right|d\\bm{\\omega}_m\\]  法線分布関数に対しては  \\[\t|\\bm{\\omega}_o\\cdot\\bm{\\omega}_n| = \\int_{H^\u0026#43;}G_1(\\bm{\\omega}_o,\\bm{\\omega}_m)D(\\bm{\\omega}_m)(\\bm{\\omega}_i\\cdot\\bm{\\omega}_m)d\\bm{\\omega}_m\\]  となる.\nShadowing-Masking Function #  光の入射方向と反射方向の, 両者の Microsurface同士の遮蔽を考慮した量を Shadowing-Masking 関数 \\(G_2(\\bm{\\omega}_i,\\bm{\\omega}_o,\\bm{\\omega}_m)\\) として導入する.  \\[\t\\int_{H^\u0026#43;}G_2(\\bm{\\omega}_i,\\bm{\\omega}_o,\\bm{\\omega}_m)D(\\bm{\\omega}_m)(\\bm{\\omega}_i\\cdot\\bm{\\omega}_m)d\\bm{\\omega}_m\\]  (後日追記予定)\nFresnel Term #  フレネル反射を \\(F(\\bm{\\omega}_m)\\) と書く.\n(後日追記予定)\nBRDF for Rough Surfaces #  以上で導入した法線分布関数と Shadowing-Masking 関数, そしてフレネル項 \\(F(\\bm{\\omega}_m)\\) を用いて, Microfacet モデルの BRDF を求める.\n BRDF, そして Masking 関数 で行った議論から, 散乱断面積 \\(\\sigma_s\\) は  \\[\\begin{aligned} \\sigma_s \u0026amp;= \\sigma_s\\int_{H^\u0026#43;_n}f_r(\\bm{\\omega}_i,\\omega_o)(\\bm{\\omega}_i\\cdot\\bm{\\omega}_n)d\\bm{\\omega}_i\\\\ \\sigma_s \u0026amp;= \\sigma_s\\int_{H^\u0026#43;_m}\\frac{G_1(\\bm{\\omega}_o,\\bm{\\omega}_m)D(\\bm{\\omega}_m)}{(\\bm{\\omega}_o\\cdot\\bm{\\omega}_n)}(\\bm{\\omega}_i\\cdot\\bm{\\omega}_m)d\\bm{\\omega}_m \\end{aligned}\\]  となる. ここで \\(\\left|\\frac{d\\bm{\\omega}_m}{d\\bm{\\omega}_i}\\right|=\\frac{1}{4(\\bm{\\omega}_i\\cdot\\bm{\\omega}_m)}\\) を使い, 2番目の式を \\(\\bm{\\omega}_m\\) から \\(\\bm{\\omega}_i\\) に変数変換すれば,  \\[\t\\sigma_s = \\sigma_s\\int_{H^\u0026#43;_n}\\frac{G_1(\\bm{\\omega}_o,\\bm{\\omega}_m)D(\\bm{\\omega}_m)}{4(\\bm{\\omega}_o\\cdot\\bm{\\omega}_n)(\\bm{\\omega}_i\\cdot\\bm{\\omega}_n)}(\\bm{\\omega}_i\\cdot\\bm{\\omega}_n)d\\bm{\\omega}_i\\]  となる. 従って, これに対応する BRDF は  \\[\tf_r(\\bm{\\omega}_i,\\bm{\\omega}_o) = \\frac{G_1(\\bm{\\omega}_o,\\bm{\\omega}_m)D(\\bm{\\omega}_m)}{4(\\bm{\\omega}_o\\cdot\\bm{\\omega}_n)(\\bm{\\omega}_i\\cdot\\bm{\\omega}_n)}\\]  となる. これに, 入射光に対する Microsurface の遮蔽を考慮して Masking 関数 \\(G_1(\\bm{\\omega}_o,\\bm{\\omega}_m)\\) を Shadowing-Masking 関数 \\(G_2(\\bm{\\omega}_i,\\bm{\\omega}_o,\\bm{\\omega}_m)\\) に変え, さらにフレネル反射項 \\(F(\\bm{\\omega}_m)\\) を導入すれば,  \\[\tf_r(\\bm{\\omega}_i,\\bm{\\omega}_o) = \\frac{F(\\bm{\\omega}_m)G_2(\\bm{\\omega}_i,\\bm{\\omega}_o,\\bm{\\omega}_m)D(\\bm{\\omega}_m)}{4(\\bm{\\omega}_o\\cdot\\bm{\\omega}_n)(\\bm{\\omega}_i\\cdot\\bm{\\omega}_n)}\\]  が得られる. これは, Microfacet モデルの BRDF として知られている.\n"});index.add({'id':7,'href':'/docs/physics/particle_mechanics/','title':"Particle Mechanics",'section':"Physics",'content':"Particle Mechanics #  Position and Velocity #  時間を \\(t\\), 3次元ユークリッド空間上の座標を \\(\\bm{q}(t)=\\begin{pmatrix}q_1(t) \\\\ q_2(t) \\\\ \\vdots \\\\ q_N(t)\\end{pmatrix}\\) と書く.\n時間についての微分を, 関数の頭にドットをつけて \\(\\dot{\\bm{r}}(t):=\\frac{d\\bm{r}(t)}{dt}\\) を略記する.\n座標を時間で微分したものを速度 \\(\\bm{v}:=\\dot{\\bm{r}}\\), 速度を時間で微分したものを加速度 \\(\\bm{a}:=\\dot{\\bm{v}}\\) とよぶ.\nNewton\u0026rsquo;s Law of Motion #  空間に点粒子を考え, その位置を \\(\\bm{r}(t)\\) とする. 粒子に加速度を与えるものを力 \\(\\bm{F}\\), 点粒子が力に影響される割合を質量 \\(m\\) とし, 質量を持った点粒子を質点と呼ぶ.\n加速度と力の関係は, ニュートンの運動方程式 (の第2法則)   \\[\t\\bm{F}=m{\\bm{a}} \\tag{nl.1}\\]  によって決まる. これにより, 質点の運動が決まる.\nこのようにモデル化する対象を力学系と呼び, 力学系の位置や速度の時間発展を運動と呼ぶ.\nHamilton\u0026rsquo;s Principle #  ニュートンの運動方程式 (nl.1) を一般化することで, 運動は作用  \\[\tS[\\bm{q}(t)] = \\int^{b}_{a}L(\\bm{q},\\dot{\\bm{q}},t)dt \\tag{hp.1}\\]  が停留点  \\[\t\\delta S[\\bm{q}(t)] = 0 \\tag{hp.2}\\]  をとる軌跡 \\(\\bm{q}(t)\\) を求める, 変分問題に帰着する. 式 (hp.2) を Hamilton の原理という.\nただし,  \\[\tL(\\bm{q},\\dot{\\bm{q}},t) = K(\\bm{q},\\dot{\\bm{q}},t) - V(\\bm{q},\\dot{\\bm{q}},t)\\]  はラグランジアン. \\(K(\\bm{q}(t),\\dot{\\bm{q}}(t),t)\\) は 力学系の運動エネルギー, \\(V(\\bm{q}(t),\\dot{\\bm{q}}(t),t)\\)はポテンシャルエネルギー.\n詳しくは, Hamiltonの原理 に記述する.\n"});index.add({'id':8,'href':'/docs/physics/statistical_mechanics/','title':"Statistical Mechanics",'section':"Physics",'content':"Statistical Mechanics #  Phase Space Distribution Function #  3次元直交座標上の粒子の座標を \\(\\bm{x}\\;[\\text{m}]\\), 運動量を \\(\\bm{p}\\;[\\text{kg}\\;\\text{m}\\;\\text{s}^{-1}]\\), 相空間内の点 \\((\\bm{x},\\bm{p})\\) の周りの体積素片を \\(d\\bm{V}:=d\\bm{x}d\\bm{p}\\;[\\text{J}^3\\;\\text{s}^3]\\) と書く.\n相空間内の閉領域 \\(V\\) に \\(N\\)個の粒子を考え, 相空間分布関数   \\[\t\\int_V f(\\bm{x},\\bm{p},t)d\\bm{V} = N \\qquad[\\text{-}],\\]  を導入する. なお, Liouville 方程式 より全粒子数は時間変化しないため, 上式の \\(N\\) は定数となる.\nこのとき, 粒子数密度は  \\[\tn(\\bm{x},t) = \\int f(\\bm{x},\\bm{p},t)d\\bm{p}\t\\qquad[\\text{m}^{-3}]\\]  と得られる.\nLiouville\u0026rsquo;s Equation #  いま, Hamiltonの運動方程式 に従って運動している \\(N\\) 個の粒子が, 相空間分布関数 \\(f(\\bm{x},\\bm{p},t)\\) で表されるとする. このとき, 分布関数に対する運動方程式を求めたい.\nいま, 単位時間当たりに\\(V\\) 内に粒子が増加する量 \\(\\int_V\\frac{\\partial f}{\\partial t}d\\bm{V}\\) と, 単位時間あたりに \\(V\\) の境界 \\(S\\) を通って粒子が流出する量 \\(\\int_S(f\\bm{v})\\cdot\\bm{n}dS\\) が等しいとして  \\[\t\\int_V\\frac{\\partial f}{\\partial t}d\\bm{V} \u0026#43; \\int_S(f\\bm{v})\\cdot\\bm{n}dS = 0\\]  とする. ここで, 相空間の速度ベクトルを \\(\\dot{\\bm{\\eta}} := \\begin{pmatrix}\\dot{\\bm{x}} \\\\ \\dot{\\bm{p}}\\end{pmatrix}\\), 領域 \\(V\\) の外側へ向かう単位ベクトルを \\(\\bm{n}\\) と書いた.\n上式の第2項に Gauss の発散定理を用いれば,  \\[\t\\int_V\\left(\\frac{\\partial f}{\\partial t} \u0026#43; \\nabla\\cdot\\left(f\\dot{\\bm{\\eta}}\\right)\\right)d\\bm{V} = 0\\]  が得られる. ここで \\(\\nabla:=\\begin{pmatrix}\\frac{\\partial}{\\partial\\bm{x}} \\\\ \\frac{\\partial}{\\partial\\bm{p}}\\end{pmatrix}\\) とした.\nさらに第2項は  \\[\\begin{aligned} \\nabla\\cdot(f\\dot{\\bm{\\eta}}) \u0026amp;= (\\nabla f)\\cdot\\dot{\\bm{\\eta}} \u0026#43; f\\,(\\nabla\\cdot\\dot{\\bm{\\eta}})\\\\ \u0026amp;= \\left(\\frac{\\partial f}{\\partial\\bm{x}}\\cdot\\dot{\\bm{x}} \u0026#43; \\frac{\\partial f}{\\partial\\bm{p}}\\cdot\\dot{\\bm{p}}\\right) \u0026#43; f\\left(\\frac{\\partial\\dot{\\bm{x}}}{\\partial\\bm{x}} \u0026#43; \\frac{\\partial\\dot{\\bm{p}}}{\\partial\\bm{p}}\\right)\\\\ \u0026amp;= \\left(\\frac{\\partial f}{\\partial\\bm{x}}\\cdot\\dot{\\bm{x}} - \\frac{\\partial f}{\\partial\\bm{p}}\\cdot\\dot{\\bm{p}}\\right) \\end{aligned}\\]  となる. 最後の等号で Hamiltonの運動方程式 \\(\\dot{\\bm{x}} = \\frac{\\partial H}{\\partial\\bm{p}},\\;\\dot{\\bm{p}} = -\\frac{\\partial H}{\\partial\\bm{x}}\\) を使った.\nこれにより,  \\[\\begin{aligned} \\frac{\\partial f}{\\partial t} \u0026#43; \\left(\\frac{\\partial f}{\\partial\\bm{x}}\\cdot\\dot{\\bm{x}} - \\frac{\\partial f}{\\partial\\bm{p}}\\cdot\\dot{\\bm{p}}\\right) = 0 \\end{aligned}\\]  が得られる. これを Liouville 方程式という.\nCollision Frequency #  粒子が速度 \\(v\\;[\\text{m}\\;\\text{s}^{-1}]\\) で, 個数密度 \\(n\\;[\\text{m}^{-3}]\\) の媒質を通過した際, 単位時間あたりに媒質に粒子が衝突する割合を考える.\n媒質の散乱断面積を \\(\\sigma_s\\;[\\text{m}^2]\\) とすれば, 距離当たりの個数密度  \\[\t\\mu=n\\sigma_s \\qquad [\\text{m}^{-1}]\\]  が得られる. これを散乱係数と呼ぶ.\n散乱係数 \\(\\mu\\) へ, 時間 \\(t\\;[\\text{s}]\\) のあいだに粒子が通過する距離 \\(vt\\;[\\text{m}]\\) を掛ければ, 媒質粒子の個数 \\(\\mu vt\\;[-]\\) が得られる. このとき, 単位時間当たりの衝突粒子数  \\[\t\\eta = \\mu v\\quad[\\text{s}^{-1}]\\]  を, 衝突率と呼ぶ.\nDifferential Cross Section #  散乱断面積が, 微小断面積 \\(d\\bm{\\sigma}\\) の集まりとして  \\[\t\\sigma_s = \\int d\\bm{\\sigma} \\qquad [\\text{m}^2]\\]  と書けるとする.\nここで, 方向 \\(\\bm{\\omega}'\\) から断面積 \\(d\\bm{\\sigma}\\) を通過してきた粒子がほかの粒子へ衝突し, 方向 \\(\\bm{\\omega}\\) の立体角 \\(d\\bm{\\omega}\\) へ散乱することを考える. このとき, 軸 \\(\\bm{\\omega}'\\) に対して \\(\\bm{\\omega}\\) のなす角を \\(\\theta, \\phi\\) と書く. さらに, 軸 \\(\\bm{\\omega}'\\) からの距離を, 衝突パラメータを \\(b\\) と書く.\n散乱が弾性散乱であれば, 断面積 \\(d\\bm{\\sigma} = bdbd\\phi\\) を通って 立体角 \\(d\\bm{\\omega} = \\sin\\theta d\\theta d\\phi\\) のあいだに  \\[\td\\bm{\\sigma} = g(\\bm{\\omega}\u0026#39;,\\bm{\\omega})d\\bm{\\omega} = bdbd\\phi \\qquad [\\text{m}^2]\\]   \\[\tg(\\bm{\\omega},\\bm{\\omega}\u0026#39;):=\\left|\\frac{d\\bm{\\sigma}}{d\\bm{\\omega}}\\right| \\qquad [\\text{m}^2\\,\\text{sr}^{-1}]\\]  という関係を作ることができる. ここで, 変数変換のヤコビアンとして導入した \\(g(\\bm{\\omega}',\\bm{\\omega})\\) を微分散乱断面積と呼ぶ. 微分散乱断面積は, 衝突パラメータ \\(b\\) を使って  \\[\tg(\\bm{\\omega}\u0026#39;,\\bm{\\omega}) = \\frac{b}{\\sin\\theta}\\left|\\frac{db}{d\\theta}\\right|\\]  と求めることができる.\nTotal Cross Section #  微分散乱断面積を全方位に渡って積分すると, 散乱断面積 \\(\\sigma_s\\)  \\[\t\\sigma_s = \\int d\\bm{\\sigma} = \\int g(\\bm{\\omega}\u0026#39;,\\bm{\\omega}) d\\bm{\\omega} \\qquad [\\text{m}^2]\\]  が得られる.\n\\[\t\\eta(\\bm{p}_1)\\]  と計算される. -- Boltzmann Equation #   Liouville 方程式 に粒子同士の衝突を表した項 \\(\\left(\\frac{\\partial f}{\\partial t}\\right)_\\text{coll}\\) を加えて  \\[\t\\frac{\\partial f}{\\partial t} \u0026#43; \\frac{\\partial f}{\\partial\\bm{x}}\\cdot\\dot{\\bm{x}} \u0026#43; \\frac{\\partial f}{\\partial\\bm{p}}\\cdot\\dot{\\bm{p}} = \\left(\\frac{\\partial f}{\\partial t}\\right)_\\text{coll}\\]  とした式を考える. 衝突項は, 衝突により \\(f\\) が増加する \\(\\left(\\frac{\\partial f}{\\partial t}\\right)_\\text{gain}\\) と, 衝突により \\(f\\) が減少する \\(\\left(\\frac{\\partial f}{\\partial t}\\right)_\\text{loss}\\) から成るとする.  \\[\t\\left(\\frac{\\partial f}{\\partial t}\\right)_\\text{coll} :=\t\\left(\\frac{\\partial f}{\\partial t}\\right)_\\text{gain} \u0026#43; \\left(\\frac{\\partial f}{\\partial t}\\right)_\\text{loss}\\]  はじめに \\(\\left(\\frac{\\partial f}{\\partial t}\\right)_\\text{loss}\\) を求める. このとき, 粒子の集団は低密度であるとして, 2体衝突のみを考慮する. 従って, 運動量 \\(\\bm{p}_1\\) と \\(\\bm{p}_2\\) の粒子が衝突し, \\(\\bm{p}'_1\\) と \\(\\bm{p}'_2\\) になる過程を考える. 以降は, 分布関数の運動量の違いだけを考えるから, \\(f(\\bm{x},\\bm{p},t)\\) を \\(f(\\bm{p})\\) と略記する.\n\\(f(\\bm{p}_1)\\) が減少する割合は, これに \\(f(\\bm{p}_2)\\) に関する 衝突率 \\(|\\bm{v}_1-\\bm{v}_2|d\\bm{\\sigma}f(\\bm{p}_2)d\\bm{p}_2\\) を掛けたものになる. \\(d\\bm{\\sigma}\\) に 微分散乱断面積 を考慮すると,  \\[\t\\left(\\frac{\\partial f(\\bm{p}_1)}{\\partial t}\\right)_\\text{loss} = \\int|\\bm{v}_1-\\bm{v}_2|g(\\bm{\\omega},\\bm{\\omega}\u0026#39;)f(\\bm{p}_1)f(\\bm{p}_2)d\\bm{p}_2d\\bm{\\omega}\\]  が得られる.\n同様にして(TBA),  \\[\t\\left(\\frac{\\partial f(\\bm{p}_1)}{\\partial t}\\right)_\\text{gain} = \\int|\\bm{v}_1-\\bm{v}_2|g(\\bm{\\omega},\\bm{\\omega}\u0026#39;)f(\\bm{p}\u0026#39;_1)f(\\bm{p}\u0026#39;_2)d\\bm{p}_2d\\bm{\\omega}\\]  が得られる.\n以上の考察から, 粒子同士の衝突を含んだ \\(f(\\bm{p}_1\\) の時間変化は  \\[\t\\frac{\\partial f(\\bm{p}_1)}{\\partial t} \u0026#43; \\frac{\\partial f(\\bm{p}_1)}{\\partial\\bm{x}}\\cdot\\dot{\\bm{x}} \u0026#43; \\frac{\\partial f(\\bm{p}_1)}{\\partial\\bm{p}_1}\\cdot\\dot{\\bm{p}_1} = \\int |\\bm{v}_1-\\bm{v}_2|g(\\bm{\\omega},\\bm{\\omega}\u0026#39;)\\left[f(\\bm{p}\u0026#39;_1)f(\\bm{p}\u0026#39;_2) - f(\\bm{p}_1)f(\\bm{p}_2)\\right]d\\bm{p}_2d\\omega\\]  という方程式で記述される. これを Boltzmann 方程式という.\nBoltzmann Equation for a Mixture #  N成分から成る希薄気体を考える. このとき, i番目の成分の変化は  \\[\t\\frac{\\partial f_i(\\bm{p}_1)}{\\partial t} \u0026#43; \\frac{\\partial f_i(\\bm{p}_1)}{\\partial\\bm{x}}\\cdot\\dot{\\bm{x}} \u0026#43; \\frac{\\partial f_i(\\bm{p}_1)}{\\partial\\bm{p}_1}\\cdot\\dot{\\bm{p}_1} = \\left(\\frac{\\partial f_i(\\bm{p}_1)}{\\partial t}\\right)_\\text{coll}\\]   \\[\t\\left(\\frac{\\partial f_i(\\bm{p}_1)}{\\partial t}\\right)_\\text{coll} = \\sum^N_{j=1}\\int |\\bm{v}_1-\\bm{v}_2|g_{ij}(\\bm{\\omega},\\bm{\\omega}\u0026#39;) \\left[f_i(\\bm{p}\u0026#39;_1)f_j(\\bm{p}\u0026#39;_2) - f_i(\\bm{p}_1)f_j(\\bm{p}_2)\\right]d\\bm{p}_2d\\bm{\\omega}\\]  と表される.\nLinear Boltzmann Equation #  2成分の Boltzmann方程式を考え, 一方の成分を A, 他方の成分を B とよぶ. ここで, B は平衡状態にあるとする. また, A同士の衝突は, AとBの衝突に比べて無視できるとして, 微分散乱断面積は \\(\\sigma = \\sigma_{AB}\\) のみを考える. (e.g. Neutron transport, photon transport)\nこのとき, Aの分布関数を \\(f\\), B の分布関数を \\(F\\) と書けば, Boltzmann 方程式は  \\[\t\\frac{\\partial f}{\\partial t} \u0026#43; \\frac{\\partial f}{\\partial\\bm{x}}\\cdot\\dot{\\bm{x}} \u0026#43; \\frac{\\partial f}{\\partial\\bm{p}}\\cdot\\dot{\\bm{p}} = \\left(\\frac{\\partial f}{\\partial t}\\right)_\\text{coll}\\]   \\[\t\\left(\\frac{\\partial f}{\\partial t}\\right)_\\text{coll} = \\int |\\bm{v}_1-\\bm{v}_2|g_{ij}(\\bm{\\omega},\\bm{\\omega}\u0026#39;) \\left[f(\\bm{p}\u0026#39;_1)F(\\bm{p}\u0026#39;_2) - f(\\bm{p}_1)F(\\bm{p}_2)\\right]d\\bm{p}_2d\\bm{\\omega}\\]  となる. これは Linear Boltzmann 方程式と呼ばれている[ Cercignani, 1988].\nRadiation #  Spectral Radiance #  光子の密度関数を \\(f_\\text{photon}(\\bm{x},\\bm{p},t)\\) としたとき, 分光放射輝度は  \\[\tL(\\bm{x},\\bm{\\omega},\\nu,t) := \\frac{2h\\nu^3}{c^2}f_\\text{photon}(\\bm{x},\\bm{p},t) \\tag{1}\\]  と書ける(TBA).\n\\[\t\\rho(\\bm{x},\\bm{p},t) = \\frac{1}{e^{h\\nu/kT}-1} \\tag{2}\\]  ボーズ・アインシュタイン分布関数で, 化学ポテンシャル \\\\(\\mu\\\\) が 0 の場合に対応する. 粒子数一定の条件を課さない場合にそうなる. https://batapara.com/archives/bose-einstein-distribution-derive.html/ ## Wien approximation 光子を古典的粒子とみなし, 熱平衡状態にある光子の相空間分布関数を求めると  \\[\t\\rho(\\bm{x},\\bm{p},t) = e^{-h\\nu/kT} \\tag{2}\\]  となる. これは, 光子同士の距離が十分離れているときに正しいが, その波長と同程度の距離になるにつれ破綻する. -- "});index.add({'id':9,'href':'/docs/physics/references/','title':"References",'section':"Physics",'content':"References #  Born, M and Wolf, E. (1999). Principles of Optics (7th Ed.). Cambridge University Press, 7th ed. #  Goldstein, H., Poole, C., and Safko, J. (2002). Classical Mechanics. Addison Wesley, 3rd ed. #  Tong, D. (2005). Lectures on Classical Dynamics. https://www.damtp.cam.ac.uk/user/tong/dynamics.html. #  山本, 義隆. (2014). 幾何光学の正準理論. 数学書房. #  "});index.add({'id':10,'href':'/docs/radiative_transfer/references/','title':"References",'section':"Radiative Transfer",'content':"References #  Chandrasekhar, S. (1960). Radiative transfer. Dover Publications Inc. #  Nicodemus, F. E. (1965). Directional reﬂectance and emissivity of an opaque surface. Appl. Opt., 4(7):767–775. #  Cook, R. L. and Torrance, K. E. (1982). A reﬂectance model for computer graphics. ACM Trans. Graph., 1(1):7–24. #  Kajiya, J. T. (1986). The rendering equation. SIGGRAPH Comput. Graph., 20(4):143–150. #  Cercignani, C. (1988). The Boltzmann Equation and Its Applications. Springer-Verlaq. #  Arvo, J. (1993). Transfer equations in global illumination. Global Illumination, SIGGRAPH’93 Course Notes. #  Jensen, H. W., Marschner, S. R., Levoy, M., and Hanrahan, P. (2001). A practical model for subsurface light transport. In Proceedings of the 28th Annual Conference on Computer Graphics and Interactive Techniques, SIGGRAPH’01, pp. 511–518. #  Walter, B., Marschner, S. R., Li, H., and Torrance, K. E. (2007). Microfacet models for refraction through rough surfaces. In Proceedings of the 18th Eurographics Conference on Rendering Techniques, EGSR’07, pages 195–206. #  Heitz, E. (2014). Understanding the masking-shadowing function in microfacet-based brdfs. Journal of Computer Graphics Techniques (JCGT), 3(2):48–107 #  Pharr, M., Jakob, W., and Humphreys, G. (2018). Physically Based Rendering: From Theory To Implementation. http://www.pbr-book.org/. #  "});index.add({'id':11,'href':'/posts/20201021_setting_up_this_site_with_hugo/','title':"Setting up this site with hugo",'section':"Blog",'content':"このウェブサイトは、 https://themes.gohugo.io/theme/hugo-book/ を元に作った。 そのときの備忘録をこの記事に残しておく。\nインストール #   https://github.com/spf13/hugo/releases から実行ファイルを取得  手元の環境は Windows 10 64bit なので、hugo_0.76.5_Windows-64bit を選択   hugo.exe を適当なディレクトリに置き、パスを通す  サイトの作成 #   サイトを作る hugo new site [サイト名]  作成したサイトのディレクトリで git init して、そこを Git のリポジトリにする  テーマの適用 #   https://themes.gohugo.io/hugo-book/ を適用する git submodule add https://github.com/alex-shpak/hugo-book themes/book  https://github.com/alex-shpak/hugo-book にある説明を見て記事を作成  サイトのプレビューと生成 #   プレビュー hugo server  public ディレクトリにサイトを生成 hugo   生成されたサイトを GitHub Pages として公開 #   GitHub Pages用のリポジトリを作成  GitHub へアクセスし、[ユーザー名].github.io という名前のリポジトリを公開設定で作成   submodule として, public ディレクトリを 1. で作成したリポジトリに割り当てる git submodule add -b main https://github.com/[ユーザー名]/[ユーザー名].github.io public  public ディレクトリへ移動し, その中身を git push git push origin main  https://[ユーザー名].github.io/ に記事が公開される  "});})();